<!--
種別: decisions
対象: 技術スタック選定
作成日: 2026-02-26
更新日: 2026-02-26
担当: AIエージェント
-->

# 技術スタック選定

## 概要

finger-tracker の技術スタックを選定する。指サック検出・3D距離計測・リアルタイム表示を実現するための言語・ライブラリ・ツールを決定する。

## 設計判断

### 判断1: 言語 — Python 3.12.3

**問題**: メイン開発言語を何にするか

**選択肢**:
1. Python
2. C++
3. Rust

**決定**: Python 3.12.3

**理由**:
- pyrealsense2, ultralytics (YOLOv8), OpenCV 等の主要ライブラリが Python で最もサポートが充実
- 既存研究環境が Python ベース
- プロトタイピングの速度を優先

**トレードオフ**:
- **利点**: 開発速度が速い、ライブラリエコシステムが豊富、学習コストが低い
- **欠点**: 実行速度がC++/Rustに劣る（ただしYOLO推論やRealSense操作はC/C++バインディング経由で実行されるため実用上問題ない）

### 判断2: 物体検出 — YOLOv8-nano

**問題**: 指サック検出にどのアルゴリズム/モデルを使うか

**選択肢**:
1. HSV色空間フィルタリング
2. YOLOv8-nano
3. MediaPipe Hand Tracking

**決定**: YOLOv8-nano (ultralytics)

**理由**:
- HSV色検出は背景の同色物体に弱く、照明条件の変化にも敏感
- YOLOv8-nanoは「指サックという物体」を認識するため、色だけに依存しない
- nanoバリアントはリアルタイム推論に十分な速度を持つ
- MediaPipeは手全体のランドマーク検出であり、指サックマーカーの検出には過剰

**トレードオフ**:
- **利点**: ロバストな検出、背景ノイズに強い、距離制限なし
- **欠点**: 学習データの準備が必要（約300枚のアノテーション）

### 判断3: アノテーション — Roboflow

**問題**: 学習データのラベリングをどう効率化するか

**選択肢**:
1. 手動ラベリング（LabelImg等）
2. Roboflow AIラベリング
3. CVAT

**決定**: Roboflow

**理由**:
- Box Prompting / Label Assist により手動作業を大幅に削減可能
- YOLOv8形式へのエクスポートが直接サポートされている
- データの前処理・拡張もプラットフォーム上で完結

**トレードオフ**:
- **利点**: 作業時間の大幅短縮、使いやすいUI
- **欠点**: クラウドサービスへの依存、無料枠の制限

### 判断4: 深度カメラ — Intel RealSense D435i

**問題**: 深度情報の取得にどのデバイスを使うか

**選択肢**:
1. Intel RealSense D435i
2. Azure Kinect
3. ステレオカメラ自作

**決定**: Intel RealSense D435i

**理由**:
- 既存研究で使用中のため追加コストなし
- pyrealsense2 による Python サポートが充実
- RGB + Depth の同期取得が容易

**トレードオフ**:
- **利点**: 既存資産活用、豊富なAPIドキュメント、高精度な深度データ
- **欠点**: Intel のRealSense事業縮小リスク（既存デバイスの利用には影響なし）

### 判断5: 環境管理 — venv + pip

**問題**: Python環境とパッケージ管理をどうするか

**選択肢**:
1. venv + pip (requirements.txt)
2. Poetry
3. conda

**決定**: venv + pip

**理由**:
- 最もシンプルで追加ツール不要
- 研究用途でパッケージ管理の複雑さは不要
- Linux PC での再現性は requirements.txt で十分

**トレードオフ**:
- **利点**: シンプル、標準ライブラリのみで完結
- **欠点**: ロックファイルによる厳密なバージョン管理なし（研究用途では許容）

## 技術スタック一覧

| レイヤー | 技術 | 用途 |
|---------|------|------|
| 言語 | Python 3.12.3 | メイン言語 |
| 物体検出 | ultralytics (YOLOv8-nano) | 指サック検出 |
| 深度カメラ | pyrealsense2 | RealSense D435i 制御 |
| 画像処理 | OpenCV | 画像表示・前処理 |
| 数値計算 | NumPy | 3D座標計算 |
| アノテーション | Roboflow | 学習データラベリング |
| 環境管理 | venv + pip | Python環境管理 |

## 関連ドキュメント

- [初期仕様書](../../archive/initial_plan.md)
- [CLAUDE.md](../../../CLAUDE.md)
