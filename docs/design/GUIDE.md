<!--
種別: ガイド
対象: 設計ドキュメント体系
作成日: 2026-02-26
更新日: 2026-02-26
担当: AIエージェント
-->

# 設計ドキュメントガイド

## 目的

finger-tracker プロジェクトの設計意図・構造・判断を記録し、開発者とAIエージェントが一貫した理解で作業できるようにする。

### 対象読者

- 開発者（本人）
- AIエージェント（Claude Code）

### 実装ステータスに関する原則

設計書に実装ステータス（「未実装」「実装済み」「Phase N で対応予定」等）を記載してはならない。実装状態の追跡は `docs/status/` で行う。

## ディレクトリ構成

```
design/
├── GUIDE.md                  # 本ガイド
├── TEMPLATE.md               # 設計書テンプレート
├── decisions/                # アーキテクチャ決定記録（ADR）
├── modules/                  # モジュール別設計書
├── flows/                    # 処理フロー図（Mermaid）
└── usecase_mapping/          # ユースケースと実装の対応表
```

## 設計書の種類と役割

| 種類 | 格納先 | 役割 |
|------|--------|------|
| ADR | `decisions/` | 技術選定・アーキテクチャ判断の記録 |
| モジュール設計書 | `modules/` | モジュールの責務・インターフェース・内部構造 |
| フロー図 | `flows/` | 処理の流れをMermaid図で視覚化 |
| ユースケースマッピング | `usecase_mapping/` | ユースケースと実装モジュールの対応 |

## セクション取捨選択

| セクション | ADR | モジュール設計 | フロー図 |
|-----------|-----|-------------|---------|
| 概要 | 必須 | 必須 | 必須 |
| 設計判断 | 必須 | — | — |
| 責務 | — | 必須 | — |
| インターフェース | — | 必須 | — |
| 内部構造 | — | 推奨 | — |
| Mermaid図 | — | 推奨 | 必須 |
| 関連ドキュメント | 必須 | 必須 | 推奨 |

## 記法規約

### Mermaid図

処理フローは Mermaid の `flowchart` または `sequenceDiagram` で記述する。

### コード参照形式

```
`src/finger_tracker/detection/tracker.py:42` — 距離計算ロジック
```

### 相互参照

相対パスで参照する:

```markdown
[技術スタック選定](./decisions/001-technology-stack.md)
[初期仕様書](../archive/initial_plan.md)
```

## AIエージェント向けルール

1. 設計書作成前に、関連する既存コードを Glob/Read で調査する
2. 既存の設計書と矛盾しないことを確認する
3. テンプレート（`TEMPLATE.md`）に従って記述する

## テンプレートの使用

ファイル命名規則:
- ADR: `{3桁番号}-{kebab-case}.md`（例: `001-technology-stack.md`）
- モジュール設計書: `{module-name}.md`（例: `detection.md`）
- フロー図: `{flow-name}.md`（例: `realtime-measurement.md`）

## 品質チェックリスト

- [ ] 全セクションが埋まっている（空セクションなし）
- [ ] Mermaid図が正しくレンダリングされる
- [ ] コード参照が実在するファイル・行を指している
- [ ] 相対パスの相互参照が正しい
- [ ] 実装ステータスが混入していない

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2026-02-26 | 初版作成 |
